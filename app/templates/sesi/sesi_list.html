<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Daftar Sesi</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
  <div class="container">
    <h2 class="mb-3">Daftar Sesi per Wahana</h2>

    <!-- Filter form -->
    <form method="get" class="row g-3 mb-4 align-items-end">
      <div class="col-md-4">
        <label class="form-label">Wahana</label>
        <select name="wahana" class="form-select">
          <option value="">Semua Wahana</option>
          {% for w in all_wahana %}
            <option value="{{ w }}" {% if current_wahana == w %}selected{% endif %}>{{ w }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-4">
        <label class="form-label">Bulan</label>
        <select name="month" class="form-select">
          <option value="">Semua Bulan</option>
          {% for m in all_months %}
            <option value="{{ m }}" {% if current_month == m %}selected{% endif %}>{{ m }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-4">
        <button type="submit" class="btn btn-primary">Tampilkan</button>
        <a href="{{ url_for('sesi_bp.sesi_add') }}" class="btn btn-success">+ Tambah Sesi</a>
      </div>
    </form>

    {% for wahana, month_data in grouped_sesi.items() %}
      <div class="card mb-4 shadow-sm">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0">{{ wahana }}</h5>
        </div>
        <div class="card-body">
          {% for month, days in month_data.items() %}
            <h6 class="text-secondary mt-3">{{ month }}</h6>
            {% for day, sessions in days.items() %}
              <h6 class="fw-semibold text-muted mt-2">{{ day }}</h6>
              <table class="table table-sm table-bordered align-middle">
                <thead class="table-light">
                  <tr>
                    <th>Nama Sesi</th>
                    <th>Mulai</th>
                    <th>Selesai</th>
                    <th>Kuota</th>
                    <th>Harga</th>
                    <th>Aksi</th>
                  </tr>
                </thead>
                <tbody>
                  {% for s in sessions %}
                  <tr>
                    <td>{{ s[1] }}</td>
                    <td>{{ s[4].strftime('%H:%M') }}</td>
                    <td>{{ s[5].strftime('%H:%M') }}</td>
                    <td>{{ s[2] }}</td>
                    <td>Rp {{ "{:,.0f}".format(s[3]) }}</td>
                    <td>
                      <a href="{{ url_for('sesi_bp.sesi_edit', id=s[0]) }}" class="btn btn-sm btn-warning">Edit</a>
                      <a href="{{ url_for('sesi_bp.sesi_delete', id=s[0]) }}"
                         class="btn btn-sm btn-danger"
                         onclick="return confirm('Hapus sesi ini?')">Hapus</a>
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            {% endfor %}
          {% endfor %}
        </div>
      </div>
    {% endfor %}

    <a href="{{ url_for('admin_bp.admin_dashboard') }}" class="btn btn-secondary">‚Üê Kembali</a>
  </div>
</body>
</html>
